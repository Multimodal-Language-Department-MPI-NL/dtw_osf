mutate(feature = factor(sub("_bin", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_z"))
df_dtw_zoom_long_z = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_z", "movement_z", "orientation_z", "position_z"),
names_to = "feature",
values_to = "similarity_z") %>%
mutate(feature = factor(sub("_z", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_bin"))
df_dtw_zoom_long = left_join(df_dtw_zoom_long, df_dtw_zoom_long_z) %>%
left_join(., df_dtw_zoom_long_bin) %>%
select(-starts_with("total_similarity"))
## for partial residual plot
df_dtw_zoom$handshape_res = residuals(lm(handshape ~ movement + orientation + position, data = df_dtw_zoom))
df_dtw_zoom$movement_res = residuals(lm(movement ~ handshape + orientation + position, data = df_dtw_zoom))
df_dtw_zoom$orientation_res = residuals(lm(orientation ~ handshape + movement + position, data = df_dtw_zoom))
df_dtw_zoom$position_res = residuals(lm(position ~ handshape + movement + orientation, data = df_dtw_zoom))
df_dtw_zoom_long_res = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_res", "movement_res", "orientation_res", "position_res"),
names_to = "feature",
values_to = "similarity_res") %>%
mutate(feature = factor(sub("_res", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(!dataset:total_similarity_z)
View(df_dtw_f2f)
library(tidyverse)
library(ggtext)
library(plotly)
library(gridExtra)    #for grid.arrange()
library(ggpubr)       #for adding stats to plots
library(patchwork)    #for combined plots
library(plotrix)      #std.error()
library(lme4)
library(lmerTest)
library(jtools)       #summ()
library(glmmTMB)
library(performance)  #check_model()
library(sjPlot)       #plot_model()
library(kableExtra)
library(svglite)      #for producing svg images
### Set global options
options(digits = 3) # set the default number of digits to 3
options(scipen=999) # turn off scientific notation (e.g., e-10)
options(dplyr.summarise.inform = FALSE)
options(render = 'normal_print')
### Rmd settings
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
### Load data
df_dtw_f2f = read_csv("data/dtw_distance_f2f.csv") %>%
select(comparison_id, pair, target, average_distance,
shape, movement, orientation, position) %>%
mutate(dataset = "f2f",
pair = as.factor(pair),
target = as.factor(target),
n_features_smop = shape + movement + orientation + position,
n_features_smo = shape + movement + orientation,
handshape = factor(ifelse(shape == 1, "similar", "not similar"),
levels = c("similar", "not similar")),
movement = factor(ifelse(movement == 1, "similar", "not similar"),
levels = c("similar", "not similar")),
orientation = factor(ifelse(orientation == 1, "similar", "not similar"),
levels = c("similar", "not similar")),
position = factor(ifelse(position == 1, "similar", "not similar"),
levels = c("similar", "not similar")))
df_dtw_zoom = read_csv("data/dtw_distance_zoom.csv") %>%
rename(target = target_2) %>%
select(comparison_id, pair, target, average_distance, average_distance, hands_dtw) %>%
mutate(dataset = "zoom",
pair = as.factor(pair),
target = as.factor(target))
df_sim_coding_zoom = read_csv("data/similarity_coding_zoom.csv") %>%
rename(position = location) %>%
mutate(total_similarity = handshape + movement + orientation + position,
### binary coding
handshape_bin = ifelse(handshape >= 4, 1, 0),
movement_bin = ifelse(movement >= 4, 1, 0),
orientation_bin = ifelse(orientation >= 4, 1, 0),
position_bin = ifelse(position >= 4, 1, 0),
n_features = handshape_bin + movement_bin + orientation_bin + position_bin,
handshape_bin = factor(handshape_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
movement_bin = factor(movement_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
orientation_bin = factor(orientation_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
position_bin = factor(position_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
### z-score
handshape_z = scale(handshape)[,1],
movement_z = scale(movement)[,1],
orientation_z = scale(orientation)[,1],
position_z = scale(position)[,1],
total_similarity_z = scale(total_similarity)[,1]) %>%
select(-notes)
### combine dtw and coding data for zoom dataset
df_dtw_zoom = right_join(df_dtw_zoom, df_sim_coding_zoom)
### convert to long format for data visualization
### f2f
df_dtw_f2f_long = df_dtw_f2f %>%
pivot_longer(cols = c("handshape", "movement", "orientation", "position"),
names_to = "feature",
values_to = "similarity")
### zoom
df_dtw_zoom_long = df_dtw_zoom %>%
pivot_longer(cols = c("handshape", "movement", "orientation", "position"),
names_to = "feature",
values_to = "similarity") %>%
select(-ends_with("_z"), -ends_with("_bin"))
df_dtw_zoom_long_bin = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_bin", "movement_bin", "orientation_bin", "position_bin"),
names_to = "feature",
values_to = "similarity_bin") %>%
mutate(feature = factor(sub("_bin", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_z"))
df_dtw_zoom_long_z = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_z", "movement_z", "orientation_z", "position_z"),
names_to = "feature",
values_to = "similarity_z") %>%
mutate(feature = factor(sub("_z", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_bin"))
df_dtw_zoom_long = left_join(df_dtw_zoom_long, df_dtw_zoom_long_z) %>%
left_join(., df_dtw_zoom_long_bin) %>%
select(-starts_with("total_similarity"))
## for partial residual plot
df_dtw_zoom$handshape_res = residuals(lm(handshape ~ movement + orientation + position, data = df_dtw_zoom))
df_dtw_zoom$movement_res = residuals(lm(movement ~ handshape + orientation + position, data = df_dtw_zoom))
df_dtw_zoom$orientation_res = residuals(lm(orientation ~ handshape + movement + position, data = df_dtw_zoom))
df_dtw_zoom$position_res = residuals(lm(position ~ handshape + movement + orientation, data = df_dtw_zoom))
df_dtw_zoom_long_res = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_res", "movement_res", "orientation_res", "position_res"),
names_to = "feature",
values_to = "similarity_res") %>%
mutate(feature = factor(sub("_res", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(!dataset:total_similarity_z)
nrow(filter(df_dtw_f2f), shape==1)
nrow(filter(df_dtw_f2f, shape==1))
nrow(filter(df_dtw_zoom, handshape_bin==1))
nrow(filter(df_sim_coding_zoom, handshape_bin==1))
nrow(filter(df_sim_coding_zoom, handshape_bin=="similar"))
126/406
library(tidyverse)
library(ggtext)
library(plotly)
library(gridExtra)    #for grid.arrange()
library(ggpubr)       #for adding stats to plots
library(patchwork)    #for combined plots
library(plotrix)      #std.error()
library(lme4)
library(lmerTest)
library(jtools)       #summ()
library(glmmTMB)
library(performance)  #check_model()
library(sjPlot)       #plot_model()
library(kableExtra)
library(svglite)      #for producing svg images
### Set global options
options(digits = 3) # set the default number of digits to 3
options(scipen=999) # turn off scientific notation (e.g., e-10)
options(dplyr.summarise.inform = FALSE)
options(render = 'normal_print')
### Rmd settings
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
### Load data
df_dtw_f2f = read_csv("data/dtw_distance_f2f.csv") %>%
select(comparison_id, pair, target, average_distance,
shape, movement, orientation, position) %>%
mutate(dataset = "f2f",
pair = as.factor(pair),
target = as.factor(target),
n_features_smop = shape + movement + orientation + position,
n_features_smo = shape + movement + orientation,
handshape = factor(ifelse(shape == 1, "similar", "not similar"),
levels = c("similar", "not similar")),
movement = factor(ifelse(movement == 1, "similar", "not similar"),
levels = c("similar", "not similar")),
orientation = factor(ifelse(orientation == 1, "similar", "not similar"),
levels = c("similar", "not similar")),
position = factor(ifelse(position == 1, "similar", "not similar"),
levels = c("similar", "not similar")))
df_dtw_zoom = read_csv("data/dtw_distance_zoom.csv") %>%
rename(target = target_2) %>%
select(comparison_id, pair, target, average_distance, average_distance, hands_dtw) %>%
mutate(dataset = "zoom",
pair = as.factor(pair),
target = as.factor(target))
df_sim_coding_zoom = read_csv("data/similarity_coding_zoom.csv") %>%
rename(position = location) %>%
mutate(total_similarity = handshape + movement + orientation + position,
### binary coding
handshape_bin = ifelse(handshape >= 4, 1, 0),
movement_bin = ifelse(movement >= 4, 1, 0),
orientation_bin = ifelse(orientation >= 4, 1, 0),
position_bin = ifelse(position >= 4, 1, 0),
n_features = handshape_bin + movement_bin + orientation_bin + position_bin,
handshape_bin = factor(handshape_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
movement_bin = factor(movement_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
orientation_bin = factor(orientation_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
position_bin = factor(position_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
### z-score
handshape_z = scale(handshape)[,1],
movement_z = scale(movement)[,1],
orientation_z = scale(orientation)[,1],
position_z = scale(position)[,1],
total_similarity_z = scale(total_similarity)[,1]) %>%
select(-notes)
### combine dtw and coding data for zoom dataset
df_dtw_zoom = right_join(df_dtw_zoom, df_sim_coding_zoom)
### convert to long format for data visualization
### f2f
df_dtw_f2f_long = df_dtw_f2f %>%
pivot_longer(cols = c("handshape", "movement", "orientation", "position"),
names_to = "feature",
values_to = "similarity")
### zoom
df_dtw_zoom_long = df_dtw_zoom %>%
pivot_longer(cols = c("handshape", "movement", "orientation", "position"),
names_to = "feature",
values_to = "similarity") %>%
select(-ends_with("_z"), -ends_with("_bin"))
df_dtw_zoom_long_bin = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_bin", "movement_bin", "orientation_bin", "position_bin"),
names_to = "feature",
values_to = "similarity_bin") %>%
mutate(feature = factor(sub("_bin", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_z"))
df_dtw_zoom_long_z = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_z", "movement_z", "orientation_z", "position_z"),
names_to = "feature",
values_to = "similarity_z") %>%
mutate(feature = factor(sub("_z", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_bin"))
df_dtw_zoom_long = left_join(df_dtw_zoom_long, df_dtw_zoom_long_z) %>%
left_join(., df_dtw_zoom_long_bin) %>%
select(-starts_with("total_similarity"))
## for partial residual plot
df_dtw_zoom$handshape_res = residuals(lm(handshape ~ movement + orientation + position, data = df_dtw_zoom))
df_dtw_zoom$movement_res = residuals(lm(movement ~ handshape + orientation + position, data = df_dtw_zoom))
df_dtw_zoom$orientation_res = residuals(lm(orientation ~ handshape + movement + position, data = df_dtw_zoom))
df_dtw_zoom$position_res = residuals(lm(position ~ handshape + movement + orientation, data = df_dtw_zoom))
df_dtw_zoom_long_res = df_dtw_zoom %>%
pivot_longer(cols = c("handshape_res", "movement_res", "orientation_res", "position_res"),
names_to = "feature",
values_to = "similarity_res") %>%
mutate(feature = factor(sub("_res", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(!dataset:total_similarity_z)
mean(df_dtw_f2f$average_distance)
mean(df_dtw_f2f$average_distance)
View(df_dtw_f2f)
mean(df_dtw_zoom$average_distance)
### Load data
df_dtw_zoom_v2 = read_csv("data/dtw_distance_zoom_mirrored.csv") %>%
rename(target = target_2) %>%
select(comparison_id, pair, target, average_distance, average_distance, hands_dtw) %>%
mutate(dataset = "zoom",
pair = as.factor(pair),
target = as.factor(target))
df_sim_coding_zoom = read_csv("data/similarity_coding_zoom.csv") %>%
rename(position = location) %>%
mutate(total_similarity = handshape + movement + orientation + position,
### binary coding
handshape_bin = ifelse(handshape >= 4, 1, 0),
movement_bin = ifelse(movement >= 4, 1, 0),
orientation_bin = ifelse(orientation >= 4, 1, 0),
position_bin = ifelse(position >= 4, 1, 0),
n_features = handshape_bin + movement_bin + orientation_bin + position_bin,
handshape_bin = factor(handshape_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
movement_bin = factor(movement_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
orientation_bin = factor(orientation_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
position_bin = factor(position_bin,
levels = c(1, 0),
labels = c("similar", "not similar")),
### z-score
handshape_z = scale(handshape)[,1],
movement_z = scale(movement)[,1],
orientation_z = scale(orientation)[,1],
position_z = scale(position)[,1],
total_similarity_z = scale(total_similarity)[,1]) %>%
select(-notes)
### combine dtw and coding data for zoom dataset
df_dtw_zoom_v2 = right_join(df_dtw_zoom_v2, df_sim_coding_zoom)
### convert to long format for data visualization
df_dtw_zoom_v2_long = df_dtw_zoom_v2 %>%
pivot_longer(cols = c("handshape", "movement", "orientation", "position"),
names_to = "feature",
values_to = "similarity") %>%
select(-ends_with("_z"), -ends_with("_bin"))
df_dtw_zoom_v2_long_bin = df_dtw_zoom_v2 %>%
pivot_longer(cols = c("handshape_bin", "movement_bin", "orientation_bin", "position_bin"),
names_to = "feature",
values_to = "similarity_bin") %>%
mutate(feature = factor(sub("_bin", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_z"))
df_dtw_zoom_v2_long_z = df_dtw_zoom_v2 %>%
pivot_longer(cols = c("handshape_z", "movement_z", "orientation_z", "position_z"),
names_to = "feature",
values_to = "similarity_z") %>%
mutate(feature = factor(sub("_z", "", feature),
levels = c("handshape", "movement", "orientation", "position"))) %>%
select(-handshape, -movement, -orientation, -position, -ends_with("_bin"))
df_dtw_zoom_v2_long = left_join(df_dtw_zoom_v2_long, df_dtw_zoom_v2_long_z) %>%
left_join(., df_dtw_zoom_v2_long_bin) %>%
select(-starts_with("total_similarity"))
mean(df_dtw_zoom_v2$average_distance)
library(tidyverse)
library(ggtext)
library(plotly)
library(gridExtra)    #for grid.arrange()
library(ggpubr)       #for adding stats to plots
library(patchwork)    #for combined plots
library(plotrix)      #std.error()
library(lme4)
library(lmerTest)
library(jtools)       #summ()
library(glmmTMB)
library(performance)  #check_model()
library(sjPlot)       #plot_model()
library(kableExtra)
library(svglite)      #for producing svg images
### Set global options
options(digits = 3) # set the default number of digits to 3
options(scipen=999) # turn off scientific notation (e.g., e-10)
options(dplyr.summarise.inform = FALSE)
options(render = 'normal_print')
### Rmd settings
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
set.seed(123)
### simulate dataframe with small effect size & large deviation (Study 2 without mirroring)
n = 1000
mean = 0.31 # mean(0.33, 0.29)
effect_size_s = -0.038
sd_l = 0.15
x = as.integer(runif(n, min=0, max=4))
y = effect_size_s*x + rnorm(n, mean, sd_l)
df1 = data.frame(x = x, y = y)
cor1 = cor.test(df1$x, df1$y, method="spearman")
m = lm(y ~ x, data=df1)
print("======= small effect size & large deviation ======")
print(cor1$estimate)
print(m$coefficients)
### simulate dataframe with small effect size & small deviation
sd_s = 0.122
x = as.integer(runif(n, min=0, max=4))
y = effect_size_s*x + rnorm(n, mean, sd_s)
df2 = data.frame(x = x, y = y)
cor2 = cor.test(df2$x, df2$y, method="spearman")
m = lm(y ~ x, data=df2)
print("======= small effect size & large deviation ======")
print(cor2$estimate)
print(m$coefficients)
### simulate dataframe with large effect size & small deviation (with mirroring)
effect_size_l = -0.047
x = as.integer(runif(n, min=0, max=4))
y = effect_size_l*x + rnorm(n, mean, sd_s)
df3 = data.frame(x = x, y = y)
cor3 = cor.test(df3$x, df3$y, method="spearman")
m = lm(y ~ x, data=df3)
print("======= large effect size & small deviation ======")
print(cor3$estimate)
print(m$coefficients)
print("======= diff in correlation score ======")
print(paste0("diff between df1 and df3: ", round(cor3$estimate - cor1$estimate, 2)))
### scatter plots
p1 = ggplot(df1, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("small effect size & large deviation")
p2 = ggplot(df2, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("small effect size & small deviation")
p3 = ggplot(df3, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("large effect size & small deviation")
grid.arrange(p1, p2, p3, ncol=3)
### simulate dataframe with large effect size & small deviation (with mirroring)
effect_size_l = -0.046
set.seed(123)
### simulate dataframe with small effect size & large deviation (Study 2 without mirroring)
n = 1000
mean = 0.31 # mean(0.33, 0.29)
effect_size_s = -0.038
sd_l = 0.15
x = as.integer(runif(n, min=0, max=4))
y = effect_size_s*x + rnorm(n, mean, sd_l)
df1 = data.frame(x = x, y = y)
cor1 = cor.test(df1$x, df1$y, method="spearman")
m = lm(y ~ x, data=df1)
print("======= small effect size & large deviation ======")
print(cor1$estimate)
print(m$coefficients)
### simulate dataframe with small effect size & small deviation
sd_s = 0.122
x = as.integer(runif(n, min=0, max=4))
y = effect_size_s*x + rnorm(n, mean, sd_s)
df2 = data.frame(x = x, y = y)
cor2 = cor.test(df2$x, df2$y, method="spearman")
m = lm(y ~ x, data=df2)
print("======= small effect size & large deviation ======")
print(cor2$estimate)
print(m$coefficients)
### simulate dataframe with large effect size & small deviation (with mirroring)
effect_size_l = -0.046
x = as.integer(runif(n, min=0, max=4))
y = effect_size_l*x + rnorm(n, mean, sd_s)
df3 = data.frame(x = x, y = y)
cor3 = cor.test(df3$x, df3$y, method="spearman")
m = lm(y ~ x, data=df3)
print("======= large effect size & small deviation ======")
print(cor3$estimate)
print(m$coefficients)
print("======= diff in correlation score ======")
print(paste0("diff between df1 and df3: ", round(cor3$estimate - cor1$estimate, 2)))
### scatter plots
p1 = ggplot(df1, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("small effect size & large deviation")
p2 = ggplot(df2, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("small effect size & small deviation")
p3 = ggplot(df3, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("large effect size & small deviation")
grid.arrange(p1, p2, p3, ncol=3)
set.seed(123)
### simulate dataframe with small effect size & large deviation (Study 2 without mirroring)
n = 1000
mean = 0.31 # mean(0.33, 0.29)
effect_size_s = -0.038
sd_l = 0.15
x = as.integer(runif(n, min=0, max=4))
y = effect_size_s*x + rnorm(n, mean, sd_l)
df1 = data.frame(x = x, y = y)
cor1 = cor.test(df1$x, df1$y, method="spearman")
m = lm(y ~ x, data=df1)
print("======= small effect size & large deviation ======")
print(cor1$estimate)
# print(m$coefficients)
### simulate dataframe with small effect size & small deviation
sd_s = 0.122
x = as.integer(runif(n, min=0, max=4))
y = effect_size_s*x + rnorm(n, mean, sd_s)
df2 = data.frame(x = x, y = y)
cor2 = cor.test(df2$x, df2$y, method="spearman")
m = lm(y ~ x, data=df2)
print("======= small effect size & large deviation ======")
print(cor2$estimate)
# print(m$coefficients)
### simulate dataframe with large effect size & small deviation (with mirroring)
effect_size_l = -0.046
x = as.integer(runif(n, min=0, max=4))
y = effect_size_l*x + rnorm(n, mean, sd_s)
df3 = data.frame(x = x, y = y)
cor3 = cor.test(df3$x, df3$y, method="spearman")
m = lm(y ~ x, data=df3)
print("======= large effect size & small deviation ======")
print(cor3$estimate)
# print(m$coefficients)
print("======= diff in correlation score ======")
print(paste0("diff between df1 and df3: ", round(cor3$estimate - cor1$estimate, 2)))
### scatter plots
p1 = ggplot(df1, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("small effect size & large deviation")
p2 = ggplot(df2, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("small effect size & small deviation")
p3 = ggplot(df3, aes(x=x, y=y)) +
geom_point(alpha=0.3) +
geom_smooth(method="lm", color="blue") +
coord_cartesian(ylim=c(0, 0.8)) +
ggtitle("large effect size & small deviation")
grid.arrange(p1, p2, p3, ncol=3)
